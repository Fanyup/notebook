## jsç®­å¤´å‡½æ•°

çœ‹äº†ä¸€ä¸‹è¿˜æŒºç®€å•çš„ğŸ‘‰[æˆ³æˆ‘](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions)

[å‡½æ•° - JavaScript | MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions)

## API

ï¼ˆæ‰‹è„šæ¶å¯åŠ¨ç¯‡çœ‹Typescriptçš„ç¬”è®°ï¼‰

### setup

![Code_wQ9jb1uidM.png](https://raw.githubusercontent.com/Fanyup/cloudimg/master/img/Code_wQ9jb1uidM.png)

å¦‚æœï¼ˆè¢«æ³¨é‡Šæ”¾å¼€ï¼‰çš„å’ŒsetupåŒæ—¶åœ¨ä¸€èµ·ï¼Œå®ƒä¿©ä¼šåˆå¹¶ï¼Œè€Œsetupä¼˜å…ˆçº§æ›´é«˜ï¼Œä¼šä¼˜å…ˆæ˜¾ç¤ºå®ƒçš„ã€‚

- setupå‡½æ•°ä¸­æ²¡æœ‰`this`ï¼Œå¹¶ä¸”ä»¥åå¼€å‘ä¸­éƒ½ä¸ä½¿ç”¨`this`äº†ã€‚

- setupä¸è¦å†™æˆ`async`å‡½æ•°ï¼Œ

### å®šä¹‰å“åº”å¼æ•°æ®ï¼šref

è¯­æ³•ï¼š`const xxx = ref(initValue):`

- jsä¸­ä¿®æ”¹æ•°æ®:`xxx.value=otherValue`

- æ¨¡æ¿ä¸­ï¼ˆä¹Ÿå°±æ˜¯<template>æ˜¾ç¤ºæ•°æ®ï¼Œä¸éœ€è¦`.value`ï¼Œç›´æ¥ä½¿ç”¨`{{xxx}}`

- ä¸€èˆ¬å®šä¹‰åŸå§‹ç±»å‹çš„å“åº”å¼æ•°æ®(strã€booleanç­‰)ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¯¹è±¡ï¼Œä¸è¿‡å®šä¹‰å¯¹è±¡æœ‰æ›´å¥½çš„æ–¹æ³•:`reactive`

```html
<template>
  <h1>é¦–é¡µ</h1>
  <p>a:{{a}}</p>
  <p>b:{{b}}</p>
  <button @click="handle">æŒ‰é’®</button>
</template>

<script lang="ts">
import { defineComponent } from 'vue';


export default defineComponent({
  name: 'HomeView',
  // data(){
  //   return {
  //     a:1,
  //     b:2
  //   };
  // },
  // methods: {
  //   handle(){
  //     console.log("handle");
  //   },
  // },
  setup() {
    console.log("setup");
    let a = 1;
    let b = 2;
    const handle = () => {
      console.log("handle2");
      a++;
      b++;
    }
    return {
      a,
      b,
      handle,
    };
  },
});
</script>
```

ä»¥è¿™ç§æ–¹å¼å®šä¹‰ğŸ‘†æ˜¯å¹¶ä¸ä¼šè§¦å‘a,b**åœ¨é¡µé¢ä¸Š** å˜åŒ–ã€‚è€Œä½¿ç”¨console.log(a,b)æ‰“å°åœ¨æ§åˆ¶å°å‘ç°ï¼Œ**æ§åˆ¶å°ä¸­**æ˜¯æœ‰å˜åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç§æ–¹å¼çš„abå˜åŒ–**ä¸æ˜¯ä¸€ç§å“åº”å¼æ•°æ®**ã€‚

å¦‚ä½•è®©a,bå˜æˆå“åº”å¼æ•°æ®ï¼Ÿ

ä¼ å…¥ref(åˆå§‹å€¼)æ–¹æ³•ï¼Œå‰ææ˜¯importå¼•å…¥å®ƒ

```html
<script lang="ts">
import { defineComponent, ref } from 'vue';
```

![Code_yxm4xF8wWg.png](https://raw.githubusercontent.com/Fanyup/cloudimg/master/img/Code_yxm4xF8wWg.png)

### å®šä¹‰å“åº”å¼å¯¹è±¡ï¼šreactive

è®°å¾—éƒ½éœ€è¦å…ˆåœ¨importä¸­å¼•å…¥

![Code_H8lyanE0li.png](https://raw.githubusercontent.com/Fanyup/cloudimg/master/img/Code_H8lyanE0li.png)

å®ƒä»¬ğŸ‘†éƒ½è¢«setup()åŒ…è£¹ã€‚è®°å¾—å°†å®ƒä»¬è¿”å›å‡ºå»ã€‚

ä¿®æ”¹stateçš„æ•°æ®**ä¸éœ€è¦a.valueäº†**

äº‹å®ä¸Šï¼Œå¦‚æœç”¨refå®šä¹‰å¯¹è±¡/æ•°ç»„ï¼Œå†…éƒ¨ä¼šè‡ªåŠ¨å°†å®ƒä»¬è½¬ä¸ºreactiveçš„å¯¹è±¡ã€‚

è¯­æ³•ï¼š`const proxy = reactive(obj):`æ¥æ”¶ä¸€ä¸ªæ˜”æ¶Œå¯¹è±¡ç„¶åè¿”å›è¯¥æ™®é€šå¯¹è±¡çš„å“åº”å¼ä»£ç†å™¨å¯¹è±¡ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€èˆ¬ç”¨æ¥å®šä¹‰ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å“åº”å¼æ•°æ®ã€‚

#### ...æ‰©å±•è¿ç®—ç¬¦å±•å¼€å¯¹è±¡

ä½†æ­¤æ—¶ï¼ŒåŸå§‹ç±»å‹æ•°æ®å¹¶ä¸ä¼šæ”¹å˜,objå¯¹è±¡ä¼šæ”¹å˜ï¼ˆå› ä¸ºå®ƒä¼šå‘ç”Ÿå¯¹è±¡å¼•ç”¨ï¼‰ã€‚

é‚£ä¹ˆ**è¯¥å¦‚ä½•è§£å†³åŸå§‹ç±»å‹æ•°æ®ä¸ä¼šæ”¹å˜çš„æ–°é—®é¢˜ï¼Ÿ**

![Code_UDYXJlXyx3.gif](https://raw.githubusercontent.com/Fanyup/cloudimg/master/img/Code_UDYXJlXyx3.gif)

#### åŒ…è£…ï¼štoRefs

ç”¨æ³•ï¼šåœ¨æ‰©å±•è¿ç®—ç¬¦è¿”å›ä¹‹å‰ç”¨toRefsæ¥åŒ…è£…ä¸€ä¸‹è¿™ä¸ªstateå¯¹è±¡ã€‚

![Code_GA3uukAKIc.gif](https://raw.githubusercontent.com/Fanyup/cloudimg/master/img/Code_GA3uukAKIc.gif)

åº”ç”¨åœºæ™¯ï¼šå¯¹reactiveå®šä¹‰çš„å¯¹è±¡è¿›è¡ŒtoRefsåŒ…è£…ï¼ŒåŒ…è£…ä¹‹åçš„å¯¹è±¡ä¸­æ¯ä¸ªå±æ€§éƒ½æ˜¯å“åº”å¼çš„ã€‚

## æ¯”è¾ƒVue2ä¸Vue3çš„å“åº”å¼åŸç†

Vue2ä¸­çš„é—®é¢˜ï¼š

1. **å¯¹è±¡ç›´æ¥æ·»åŠ æ–°çš„å±æ€§** æˆ–é™¤å·²æœ‰å±æ€§ï¼Œ**ç•Œé¢ä¸ä¼šè‡ªåŠ¨æ›´æ–°**ï¼Œä¸æ˜¯å“åº”å¼ã€‚

2. ç›´æ¥**é€šè¿‡ä¸‹æ ‡ä¿®æ”¹**å…ƒç´ `(arr[1]=xxx)`æˆ–**æ›´æ–°æ•°ç»„**çš„`length`ï¼Œ**ç•Œé¢ä¸ä¼šè‡ªåŠ¨æ›´æ–°**ï¼Œä¸æ˜¯å“åº”å¼ã€‚

åŒæ ·çš„ä»£ç ï¼Œåœ¨vue3ä¸­æ²¡é—®é¢˜ã€‚

### vue2å“åº”å¼åŸç†æ ¸å¿ƒ

é€šè¿‡`defineProperty`è¿™ä¸ªAPIå¯¹**å¯¹è±¡ï¼ˆåˆ’é‡ç‚¹ï¼‰çš„å·²æœ‰å±æ€§å€¼**çš„è¯»å–å’Œä¿®æ”¹è¿›è¡ŒåŠ«æŒï¼ˆç›‘è§†/æ‹¦æˆªï¼‰

![chrome_2rXzkqG0x9.png](https://raw.githubusercontent.com/Fanyup/cloudimg/master/img/chrome_2rXzkqG0x9.png)

`prop`æ˜¯è¦æ‹¦æˆªçš„å±æ€§ï¼Œç¬¬ä¸‰ä¸ªæ˜¯é…ç½®å¯¹è±¡ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªå±æ€§`get`ä¸`set`

è¯¦æƒ…çœ‹ğŸ‘‰[è§†é¢‘](https://www.bilibili.com/video/BV18K4y1T7Nc/?p=5&spm_id_from=pageDriver&vd_source=baf5a4288b31a243832175ddb5cbd481)ï¼ˆæ¼”ç¤ºé‡ç‚¹çœ‹7åˆ†30å·¦å³ï¼‰

è€Œ**æ•°ç»„çš„push(å¢åŠ )ã€pop(è¸¢å‡º)ã€spliceï¼ˆåˆ é™¤æˆ–æ›¿æ¢ç°æœ‰å…ƒç´ /åŸåœ°æ·»åŠ æ–°çš„å…ƒç´ ï¼‰ç­‰æ–¹æ³•**ä¹‹æ‰€ä»¥**èƒ½æ­£å¸¸ä½¿ç”¨**ï¼Œå…¶å®æ˜¯å› ä¸ºvueé‡å†™äº†ã€‚
